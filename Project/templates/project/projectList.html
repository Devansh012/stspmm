{% extends "registration/base.html" %}
{% block content %}
    <h2>Project List</h2>
    <a href="{% url 'projectCreateView' %}">
        <button type="button" class="btn btn-primary btn-sm" style="float:right;">Add New</button>
    </a>
    <table class="table">
        <tr>
            <th>Project Name</th>
            <th>Cost</th>
            <th>Agency</th>
            <th>Description</th>
            <th>Date Of Commencement</th>
            <th>Last Date Of Delivery</th>
            <th>Sector</th>
            <th>Scope Items</th>
            <th>Project Proposal</th>
            <th>Actions</th>
        </tr>
        {% for pj in project %}
        <tr>
            <td>{{ pj.projectName }}</td>
            <td>{{ pj.cost }}</td>
            <td>{{ pj.agency }}</td>
            <td>{{ pj.description }}</td>
            <td>{{ pj.dateOfCommencement }}</td>
            <td>{{ pj.lastDateOfDelivery }}</td>
            <td>{{ pj.sector }}</td>
            <td>{{ pj.scopeItems }}</td>
            <td>
                <a href="{% url 'ppList' pj.id %}">
                    <button type="button" class="btn btn-primary">Project Proposal</button>
                </a>
            </td>
            <td>
                <a href="{% url 'projectUpdateView' pj.id %}">
                    <button type="button" class="btn btn-primary">Edit</button>
                </a>
                <form action="{% url 'projectDeleteView' pj.id %}" method="post" style="display:inline;" id="delete-form-{{pj.id}}">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">Delete</button>
                </form>
                <script>
                  document.querySelector('#delete-form-{{ pj.id }}').addEventListener('submit', function (event) {
                    if (!confirm('Are you sure you want to delete this item "{{ pj.projectName }}"?')) {
                      event.preventDefault(); // Prevent form submission if the user cancels
                    }
                  });
                </script>
            </td>
        </tr>
        {% endfor %}
    </table>
{% endblock %}
